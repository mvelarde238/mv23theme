/*! gjs-row-and-cols - 1.1.3 */
!function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports["gjs-row-and-cols"]=t():e["gjs-row-and-cols"]=t()}('undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:this,()=>(()=>{"use strict";var e={d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})}},t={};e.r(t),e.d(t,{default:()=>x});const o=function(e){const t=e.getDeviceControl(),o=t.widths,n=t.orders;let l={type:'options',title:'COLUMNS WIDTH (%)',options:[{type:'button',label:'<i style="font-size: 17px;" class="material-symbols-outlined">lock</i>',command:'locked-widths-toggle',class:t.locked?'active':'',rerender:{full:!0}}]};return n.forEach((e,t)=>{l.options.push({type:'input',value:o[e],inputType:'number',min:1,max:100,rerender:{full:!0},command:'update-width',args:{order:t}})}),l},n=function(e){const t=e.getDeviceControl(),o=e.components(),n=t.locked;let l={type:'options',title:'COLUMNS WIDTH PRESETS',options:[]};return 2==o.length&&n&&(l.options=[{type:'button',label:'1/2 - 1/2',command:'column-width-presets',rerender:{partial:!0},args:{preset:'1/2-1/2'}},{type:'button',label:'1/3 - 2/3',command:'column-width-presets',rerender:{partial:!0},args:{preset:'1/3-2/3'}},{type:'toggle'},{type:'button',label:'2/3 - 1/3',command:'column-width-presets',rerender:{partial:!0},args:{preset:'2/3-1/3'}},{type:'button',label:'1/4 - 3/4',command:'column-width-presets',rerender:{partial:!0},args:{preset:'1/4-3/4'}},{type:'button',label:'3/4 - 1/4',command:'column-width-presets',rerender:{partial:!0},args:{preset:'3/4-1/4'}}]),3==o.length&&n&&(l.options=[{type:'button',label:'1/3 - 1/3 - 1/3',command:'column-width-presets',rerender:{partial:!0},args:{preset:'1/3-1/3-1/3'}},{type:'button',label:'1/4 - 2/4 - 1/4',command:'column-width-presets',rerender:{partial:!0},args:{preset:'1/4-2/4-1/4'}},{type:'toggle'},{type:'button',label:'1/8 - 3/8 - 4/8',command:'column-width-presets',rerender:{partial:!0},args:{preset:'1/8-3/8-4/8'}}]),4==o.length&&n&&(l.options=[{type:'button',label:'1/4 - 1/4 - 1/4 - 1/4',command:'column-width-presets',rerender:{partial:!0},args:{preset:'1/4-1/4-1/4-1/4'}}]),l},l=function(e){return{type:'button',command:'locked-components-toggle',rerender:{partial:!0},class:()=>e.get('lockedComponents')?'active':'',label:()=>e.get('lockedComponents')?'Unlock inner components':'Lock inner components'}},d=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:'forward',n=null;const l=e.components();if(l.length>1){let d=null;'forward'===o&&(d=t<l.length-1?t+1:t-1),'backward'===o&&(d=t>0?t-1:t+1),null!=d&&(n=e.getChildAt(d))}return n},r={tl:0,tc:0,tr:0,cl:1,cr:1,bl:0,br:0,bc:0,minDim:8,keyWidth:'width',unitWidth:'%',maxDim:100};let i=null;r.updateTarget=function(e,t,o){const n=o.resizer.opts.editor;let l=n.getSelected(),r=l.parent(),s=r.getDeviceControl(),a=t.w,c=o.selectedHandler,p=s.orders.indexOf(l.cid),m='cr'==c?d(r,p):d(r,p,'backward'),g=s.widths[m.cid],u=s.widths[l.cid],h={width:a+'%'},f={widths:{...s.widths}},b=s.locked;if(l.addStyle(h),f.widths[l.cid]=a,b&&m){const e=g-(a-u);m.addStyle({width:e+'%'}),f.widths[m.cid]=e}r.updateControl(f),clearTimeout(i),i=setTimeout(()=>{!function(e){e.contextMenu.trigger('rerender:actions')}(n)},250)};const s=e=>{const t=e.DomComponents;r.editor=e,t.addType('col',{isComponent:e=>e.classList&&e.classList.contains('rcb-col'),model:{defaults:{name:'Column',tagName:'div',draggable:'.rcb-row',droppable:!0,copyable:!1,resizable:r,lockedComponents:!1,attributes:{class:'.rcb-col'},styles:`.rcb-col{ min-height: 50px }`,contextMenu:function(e){let t=[],d=[],r=[];d.push({type:'button',command:'add-col',rerender:{full:!0},label:'Add Column'});let i=o(e.parent());d.push(i),d.push({type:'options',title:'CONTENT ALIGNMENT',options:[{type:'button',label:'Top',command:'col-content-alignment',args:{alignment:'flex-start'}},{type:'button',label:'Center',command:'col-content-alignment',args:{alignment:'center'}},{type:'button',label:'Bottom',command:'col-content-alignment',args:{alignment:'flex-end'}},{type:'toggle'},{type:'button',label:'Between',command:'col-content-alignment',args:{alignment:'space-between'}},{type:'button',label:'Around',command:'col-content-alignment',args:{alignment:'space-around'}},{type:'button',label:'Evenly',command:'col-content-alignment',args:{alignment:'space-evenly'}}]});let s=n(e.parent());s.options.length>0&&r.push(s),r.push(l(e));return e.parent().components().length>1&&r.push({type:'button',command:'remove-col',label:'Delete Column',class:"danger"}),t.push({type:'options',gap:30,options:[{type:'options',class:'column',options:d},{type:'options',class:'column',options:r}]}),t}}},view:{defaults:{attributes:{'data-gjs-draggable':'.rcb-row'}}}})},a=e=>{e.DomComponents.addType('row2',{isComponent:e=>e.classList&&e.classList.contains('rcb-row'),model:{defaults:{name:'Row',tagName:'div',draggable:!0,droppable:function(e,t){return e.parent()==t},resizable:!1,lockedComponents:!1,attributes:{class:'rcb-row'},components:[{type:'col'},{type:'col'}],style:{display:'flex'},contextMenu:function(e){let t=[],d=[],r=[];const i=e.getDeviceControl().gap;d.push({type:'button',command:'add-col',label:'Add Column',rerender:{full:!0}});let s=o(e);d.push(s),d.push({type:'options',title:'COLUMNS ALIGNMENT',options:[{type:'button',label:'Left',command:'cols-alignment',args:{alignment:'flex-start'}},{type:'button',label:'Center',command:'cols-alignment',args:{alignment:'center'}},{type:'button',label:'Right',command:'cols-alignment',args:{alignment:'flex-end'}},{type:'toggle'},{type:'button',label:'Between',command:'cols-alignment',args:{alignment:'space-between'}},{type:'button',label:'Around',command:'cols-alignment',args:{alignment:'space-around'}},{type:'button',label:'Evenly',command:'cols-alignment',args:{alignment:'space-evenly'}}]});let a=n(e);return a.options.length>0&&r.push(a),r.push({type:'range',title:'SPACE BETWEEN COLUMNS',command:'update-gap',min:0,value:parseInt(i)}),r.push(l(e)),t.push({type:'options',gap:30,options:[{type:'options',class:'column',options:d},{type:'options',class:'column',options:r}]}),t}},init:function(){void 0===this.get('control')?this.initControl():this.normalizeControl()},initControl:function(){let t={},o=this.components(),n=e.Devices.getDevices();return n.forEach((e,l)=>{const d=0===l,r=l===n.length-1;if(d||r){t[e.id]={};let n=!r;t[e.id].locked=n;let l=parseInt('1%');if(d&&(t[e.id].gap=l),d){let n=[];o.forEach((e,t)=>{n[t]=e.cid}),t[e.id].orders=n}let i=l*(o.length-1),s=r?100:(100-i)/o.length,a={};o.forEach((e,t)=>{a[e.cid]=s}),t[e.id].widths=a}}),this.set('control',t),t},normalizeControl:function(){let t=this.get('control'),o=JSON.stringify(t),n=this.components(),l=e.getDevice();n.forEach((e,n)=>{o=o.replaceAll(t[l].orders[n],e.cid)}),this.set('control',JSON.parse(o))},getDeviceControl(){const t=this.get('control'),o=e.Devices.getDevices(),n=e.getDevice();let l={};return o.every((e,o)=>(l={...l,...t[e.id]},e.id!==n)),l},updateControl(t){const o=this.get('control'),n=e.getDevice();void 0===o[n]&&(o[n]={}),o[n]={...o[n],...t}},onAddColumn(){const t=this.components();2===t.length&&t.models.map(e=>{e.set({removable:!0})});const o=this.get('control'),n=e.Devices.getDevices(),l=t.models[t.length-1].cid;n.forEach((e,n)=>{if(0===n){let n=o[e.id].locked,d=o[e.id].widths;if(n){let n=(100-o[e.id].gap*(t.length-1))/t.length;d={},t.forEach((e,t)=>{d[e.cid]=n})}else d[l]=100;o[e.id].widths=d,o[e.id].orders.push(l)}else o[e.id]&&(null!=o[e.id].locked&&!1===o[e.id].locked?(o[e.id].widths&&(o[e.id].widths[l]=100),o[e.id].orders&&o[e.id].orders.push(l)):(o[e.id].widths&&delete o[e.id].widths,o[e.id].orders&&delete o[e.id].orders))}),this.getView().renderControl()}},view:{defaults:{attributes:{'data-gjs-droppable':'.rcb-col'}},onRender(){this.renderControl()},renderControl(){const e=this.model.getDeviceControl(),t=this.model,o=t.components(),n=e.locked,l=e.gap,d=e.widths,r=e.orders;t.addStyle({gap:`${l}%`,'flex-wrap':n?'nowrap':'wrap'}),r.forEach((e,n)=>{let l=o.find(t=>t.cid==e);l.move(t,{at:n}),l.addStyle({width:`${d[e]}%`,order:n})})}}})},c=e=>{e.add('col-content-alignment',function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o.component;'col'==n.attributes.type&&n.addStyle({display:'flex','flex-direction':'column','justify-content':o.alignment})})},p=e=>{e.add('cols-alignment',function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o.component;'row2'==n.attributes.type&&n.addStyle({'justify-content':o.alignment})})},m=e=>{e.add('add-col',function(e,t){let o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).component,n='col'==o.attributes.type?o.parent():o;n.append({type:'col'}),n.onAddColumn()})},g=e=>{e.add('remove-col',function(e,t){let o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).component,n=!0,l=o.components();1!=o.parent().components().length&&(l.length>0&&(n=confirm('Are you sure you want to remove this item? There are components inside')),n&&o.remove())})},u=e=>{e.add('column-width-presets',function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(o.preset){let t=o.preset.split('-');if(t.length){const n=o.component,l=n.get('type'),d='col'==l?n.parent():n,r='col'==l?n.parent().components():n.components(),i=100-d.getDeviceControl().gap*(r.length-1),s={widths:{}};r.forEach((e,o)=>{let n=t[o].split('/'),l=i/n[1]*n[0];e.addStyle({width:`${l}%`}),s.widths[e.cid]=l}),d.updateControl(s),e.contextMenu.trigger('rerender:actions')}}})},h=e=>{e.add('update-gap',function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o.component,l='col'==n.attributes.type?n.parent():n,d=o.value,r=l.getDeviceControl(),i=r.locked,s={};if(l.addStyle({gap:d+'%'}),s.gap=d,i){let e=l.components(),t=r.gap,o=1/e.length;s.widths={...r.widths},e.forEach((e,n)=>{let l=s.widths[e.cid]+o*(t-d);e.addStyle({width:`${l}%`}),s.widths[e.cid]=l})}l.updateControl(s)}),e.add('update-gap:end',function(e,t){e.contextMenu.trigger('rerender:actions')})},f=e=>{e.add('update-width',function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(''==o.value||0==o.value)return;let n=o.component,l='col'==n.attributes.type?n.parent():n,r=l.getDeviceControl(),i=l.getChildAt(o.order),s=parseFloat(o.value),a=r.widths[i.cid],c=d(l,o.order),p=c?r.widths[c.cid]:null,m=c?p-(s-a):null,g=r.locked,u={widths:{...r.widths}};g&&c&&m<8||(i.addStyle({width:s+'%'}),u.widths[i.cid]=s,g&&c&&(c.addStyle({width:m+'%'}),u.widths[c.cid]=m),l.updateControl(u))})},b=e=>{e.add('locked-widths-toggle',function(e,t){let o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).component,n='col'==o.attributes.type?o.parent():o,l={locked:!n.getDeviceControl().locked};n.updateControl(l),n.getView().renderControl()})},y=e=>{e.add('locked-components-toggle',function(e,t){let o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).component,n=o.get('lockedComponents');o.components().forEach(e=>{e.set('locked',!n)}),o.set('lockedComponents',!n)})},w=e=>{e.on('change:device',t=>{const o=e.getWrapper().findType('row2');o.length&&o.forEach(e=>{e.getView().renderControl()})})},v=e=>{e.on('component:drag:end',t=>{if(t.target.is('col')){const o=t.parent,n=o.components(),l={orders:[]};n.forEach((e,t)=>{e.addStyle({order:t})}),n.forEach((e,t)=>{l.orders[t]=e.cid}),o.updateControl(l),e.contextMenu.trigger('rerender:actions')}})},C=e=>{e.on('component:remove',t=>{if(t.is('col')){const o=t.parent(),n=o.components(),l=o.get('control'),d=e.Devices.getDevices(),r=t.cid;d.forEach((e,t)=>{if(0===t){let t=l[e.id].locked,o=l[e.id].widths,d=l[e.id].orders;if(delete o[r],d=d.filter((e,t,o)=>e!=r),t){let t=(100-l[e.id].gap*(n.length-1))/n.length;n.forEach((e,n)=>{o[e.cid]=t})}l[e.id].widths=o,l[e.id].orders=d}else if(l[e.id])if(null!=l[e.id].locked&&!1===l[e.id].locked){if(l[e.id].widths&&delete l[e.id][r],l[e.id].orders){let t=l[e.id].orders.filter((e,t,o)=>e!=r);l[e.id].orders=t}}else l[e.id].widths&&delete l[e.id].widths,l[e.id].orders&&delete l[e.id].orders}),o.getView().renderControl(),1==n.length&&n.models[0].set({removable:!1})}})},k=e=>{e.on('component:clone',e=>{e.is('row2')&&e.normalizeControl()})},D=e=>{e.on('component:mount',e=>{if('col'===e.parent().attributes.type){const t=e.parent();t.get('lockedComponents')&&t.components().forEach(e=>{e.set('locked',!0)})}})},E=e=>{e.on('before:paste:styles',()=>{let t=e.contextMenu.model.get('clipboard')||{},o=t.cmp.attributes.type;'col'===o&&(delete t.styles.width,delete t.styles.order),'row2'===o&&delete t.styles.gap})},S={'gjs-row-and-cols':{}},x=function(e){const t={i18n:{},...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}},o=['.rcb-col','.rcb-row','.has-columns'];e.on('selector:add',e=>o.indexOf(e.getFullName())>=0&&e.set('private',1)),function(e){[s,a].map(t=>t(e))}(e),function(e){e.on('load',(t,o)=>{e.BlockManager.add('row2',{label:'Row',media:'<svg xmlns="http://www.w3.org/2000/svg" height="40" width="40"><path d="M6.667 30V10h26.666v20Zm1.416-1.417h7V11.417h-7Zm8.417 0h7V11.417h-7Zm8.417 0h7V11.417h-7Z"/></svg>',category:'Structure',content:{type:'row2'}})})}(e),(e=>{const t=e.Commands;[c,p,m,g,u,h,b,f,y].map(e=>e(t))})(e),(e=>{[w,v,C,k,D,E].map(t=>t(e))})(e),e.I18n&&e.I18n.addMessages({en:S,...t.i18n})};return t})());
//# sourceMappingURL=index.js.map